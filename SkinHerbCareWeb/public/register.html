<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô - SkinHerbCare</title>

    <!-- ‚úÖ ‡πÉ‡∏ä‡πâ Tailwind CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå Sarabun ‡∏à‡∏≤‡∏Å Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .password-mismatch { border-color: #ef4444; } /* red-500 */
    </style>
</head>

<body class="bg-green-50 flex items-center justify-center min-h-screen">
    <!-- ‚úÖ ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ -->
    <main class="bg-white p-8 md:p-10 rounded-2xl shadow-2xl w-full max-w-md m-4 border border-green-100">
        
        <!-- ‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ -->
        <div class="text-center mb-8">
            <div class="inline-flex items-center justify-center w-12 h-12 rounded-2xl bg-green-100 mb-3">
                <span class="text-2xl">üåø</span>
            </div>
            <h1 class="text-4xl font-bold text-green-800 tracking-tight">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡∏°‡πà</h1>
            <p class="text-gray-500 mt-2">‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÇ‡∏£‡∏Ñ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô</p>
        </div>

        <!-- ‚úÖ ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô -->
        <form id="registerForm" class="space-y-4">
            
            <!-- üî∏ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠</label>
                    <input type="text" id="firstName" name="firstName" required
                        class="w-full px-3 py-2.5 border border-gray-200 rounded-lg shadow-sm
                               focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500 transition">
                </div>

                <div>
                    <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                    <input type="text" id="lastName" name="lastName" required
                        class="w-full px-3 py-2.5 border border-gray-200 rounded-lg shadow-sm
                               focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500 transition">
                </div>
            </div>

            <!-- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°: ‡∏≠‡∏≤‡∏¢‡∏∏ + ‡∏≠‡∏≤‡∏ä‡∏µ‡∏û -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="age" class="block text-sm font-medium text-gray-700 mb-1">‡∏≠‡∏≤‡∏¢‡∏∏</label>
                    <input type="number" id="age" name="age" required min="1" max="120"
                        class="w-full px-3 py-2.5 border border-gray-200 rounded-lg shadow-sm
                               focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500 transition"
                        placeholder="‡πÄ‡∏ä‡πà‡∏ô 25">
                </div>

                <div>
                    <label for="occupation" class="block text-sm font-medium text-gray-700 mb-1">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</label>
                    <input type="text" id="occupation" name="occupation" required
                        class="w-full px-3 py-2.5 border border-gray-200 rounded-lg shadow-sm
                               focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500 transition"
                        placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏™‡∏±‡∏á‡∏´‡∏≤">
                </div>
            </div>

            <!-- üî∏ ‡∏≠‡∏µ‡πÄ‡∏°‡∏• -->
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-1">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                <input type="email" id="email" name="email" required
                    class="w-full px-3 py-2.5 border border-gray-200 rounded-lg shadow-sm
                           focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500 transition"
                    placeholder="you@example.com">
            </div>

            <!-- üî∏ ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô -->
            <div>
                <label for="password" class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                <input type="password" id="password" name="password" required
                    class="w-full px-3 py-2.5 border border-gray-200 rounded-lg shadow-sm
                           focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500 transition">
                <div class="mt-2 flex items-center justify-between">
                    <button type="button" id="togglePassword"
                        class="text-xs text-green-700 hover:text-green-800 font-medium">
                        ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
                    </button>

                    <span id="passwordStrengthText" class="text-xs text-gray-500">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á: -</span>
                </div>

                <!-- Strength bar -->
                <div class="mt-2 w-full h-2 rounded-full bg-gray-100 overflow-hidden">
                    <div id="passwordStrengthBar" class="h-2 w-0 bg-red-500 transition-all"></div>
                </div>

                <p class="text-xs text-gray-500 mt-2">
                    ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å/‡πÉ‡∏´‡∏ç‡πà + ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
                </p>
            </div>

            <!-- üî∏ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô -->
            <div>
                <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                <input type="password" id="confirmPassword" name="confirmPassword" required
                    class="w-full px-3 py-2.5 border border-gray-200 rounded-lg shadow-sm
                           focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500 transition">
                <div class="mt-2 flex items-center justify-between">
                    <button type="button" id="toggleConfirmPassword"
                        class="text-xs text-green-700 hover:text-green-800 font-medium">
                        ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
                    </button>
                    <p id="passwordError" class="text-red-500 text-xs hidden">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô</p>
                </div>
            </div>
            
            <!-- üîò ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô -->
            <button type="submit"
                class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-xl
                       hover:bg-green-700 focus:outline-none focus:ring-2
                       focus:ring-offset-2 focus:ring-green-500 transition duration-300 shadow-lg shadow-green-600/20">
                ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
            </button>
        </form>

        <!-- üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö -->
        <p class="text-center text-sm text-gray-600 mt-6">
            ‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß?
            <a href="/login.html" class="font-medium text-green-600 hover:text-green-500">
                ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            </a>
        </p>

    </main>

    <!-- ‚úÖ ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡πÄ‡∏î‡∏¥‡∏°) -->
    <script>
        const form = document.getElementById('registerForm');
        const password = document.getElementById('password');
        const confirmPassword = document.getElementById('confirmPassword');
        const passwordError = document.getElementById('passwordError');

        const checkPasswords = () => {
            if (password.value !== confirmPassword.value && confirmPassword.value !== '') {
                confirmPassword.classList.add('password-mismatch');
                passwordError.classList.remove('hidden');
                return false;
            } else {
                confirmPassword.classList.remove('password-mismatch');
                passwordError.classList.add('hidden');
                return true;
            }
        };

        password.addEventListener('input', checkPasswords);
        confirmPassword.addEventListener('input', checkPasswords);

        form.addEventListener('submit', (event) => {
            event.preventDefault();
            const passwordsMatch = checkPasswords();

            if (passwordsMatch) {
                console.log('Form is valid and ready to be submitted.');
                alert('‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ù‡∏±‡πà‡∏á Frontend)');
            } else {
                console.log('Form submission blocked due to password mismatch.');
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô');
            }
        });
    </script>

    <!-- ‚úÖ ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°) -->
    <script>
    /* ===========================
       ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°)
       =========================== */

    const firstNameEl = document.getElementById('firstName');
    const lastNameEl = document.getElementById('lastName');
    const ageEl = document.getElementById('age');                 // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°
    const occupationEl = document.getElementById('occupation');   // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°
    const emailEl = document.getElementById('email');
    const submitBtn = form.querySelector('button[type="submit"]');

    const togglePasswordBtn = document.getElementById('togglePassword');
    const toggleConfirmPasswordBtn = document.getElementById('toggleConfirmPassword');
    const passwordStrengthBar = document.getElementById('passwordStrengthBar');
    const passwordStrengthText = document.getElementById('passwordStrengthText');

    const normalizeInputs = () => {
      firstNameEl.value = firstNameEl.value.replace(/\s+/g, ' ').trimStart();
      lastNameEl.value = lastNameEl.value.replace(/\s+/g, ' ').trimStart();
      occupationEl.value = occupationEl.value.replace(/\s+/g, ' ').trimStart(); // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°
      emailEl.value = emailEl.value.trim().toLowerCase();
    };

    const passwordRules = {
      minLen: 8,
      lower: /[a-z]/,
      upper: /[A-Z]/,
      digit: /\d/
    };

    const getPasswordScore = (pw) => {
      let score = 0;
      if (!pw) return 0;
      if (pw.length >= passwordRules.minLen) score += 1;
      if (passwordRules.lower.test(pw)) score += 1;
      if (passwordRules.upper.test(pw)) score += 1;
      if (passwordRules.digit.test(pw)) score += 1;
      if (pw.length >= 12) score += 1;
      return Math.min(score, 5);
    };

    const renderPasswordStrength = () => {
      const pw = password.value;
      const score = getPasswordScore(pw);

      const widths = ["0%", "20%", "40%", "60%", "80%", "100%"];
      passwordStrengthBar.style.width = widths[score];

      const labels = ["-", "‡∏≠‡πà‡∏≠‡∏ô‡∏°‡∏≤‡∏Å", "‡∏≠‡πà‡∏≠‡∏ô", "‡∏Å‡∏•‡∏≤‡∏á", "‡∏î‡∏µ", "‡∏î‡∏µ‡∏°‡∏≤‡∏Å"];
      passwordStrengthText.textContent = `‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á: ${labels[score]}`;

      passwordStrengthBar.classList.remove('bg-red-500', 'bg-yellow-500', 'bg-green-500');
      if (score <= 2) passwordStrengthBar.classList.add('bg-red-500');
      else if (score === 3) passwordStrengthBar.classList.add('bg-yellow-500');
      else passwordStrengthBar.classList.add('bg-green-500');
    };

    const applyPasswordValidity = () => {
      const pw = password.value;
      const okMin =
        pw.length >= passwordRules.minLen &&
        passwordRules.lower.test(pw) &&
        passwordRules.upper.test(pw) &&
        passwordRules.digit.test(pw);

      if (!okMin && pw.length > 0) {
        password.setCustomValidity('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å/‡πÉ‡∏´‡∏ç‡πà ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç');
      } else {
        password.setCustomValidity('');
      }

      if (confirmPassword.value && password.value !== confirmPassword.value) {
        confirmPassword.setCustomValidity('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô');
      } else {
        confirmPassword.setCustomValidity('');
      }
    };

    const toggleVisibility = (inputEl, btnEl) => {
      const isHidden = inputEl.type === 'password';
      inputEl.type = isHidden ? 'text' : 'password';
      btnEl.textContent = isHidden ? '‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô' : '‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô';
    };

    if (togglePasswordBtn) {
      togglePasswordBtn.addEventListener('click', () => toggleVisibility(password, togglePasswordBtn));
    }
    if (toggleConfirmPasswordBtn) {
      toggleConfirmPasswordBtn.addEventListener('click', () => toggleVisibility(confirmPassword, toggleConfirmPasswordBtn));
    }

    const updateSubmitState = () => {
      applyPasswordValidity();

      // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°: age/occupation ‡πÄ‡∏õ‡πá‡∏ô required ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏
      const age = parseInt(ageEl.value || "0", 10);
      if (ageEl.value && (age < 1 || age > 120)) {
        ageEl.setCustomValidity('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏≤‡∏¢‡∏∏ 1-120');
      } else {
        ageEl.setCustomValidity('');
      }

      const isValid = form.checkValidity() && checkPasswords();
      submitBtn.disabled = !isValid;
      submitBtn.classList.toggle('opacity-60', !isValid);
      submitBtn.classList.toggle('cursor-not-allowed', !isValid);
    };

    [firstNameEl, lastNameEl, emailEl, ageEl, occupationEl].forEach(el => {
      el.addEventListener('input', () => {
        normalizeInputs();
        updateSubmitState();
        saveDraft();
      });
    });

    password.addEventListener('input', () => {
      renderPasswordStrength();
      applyPasswordValidity();
      updateSubmitState();
    });

    confirmPassword.addEventListener('input', () => {
      applyPasswordValidity();
      updateSubmitState();
    });

    let isSubmitting = false;

    form.addEventListener('submit', () => {
      applyPasswordValidity();
      updateSubmitState();
      if (!form.checkValidity()) return;

      if (isSubmitting) return;
      isSubmitting = true;

      const originalText = submitBtn.textContent;
      submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô...';
      submitBtn.disabled = true;

      setTimeout(() => {
        submitBtn.textContent = originalText;
        isSubmitting = false;
        updateSubmitState();
      }, 900);
    }, true);

    const DRAFT_KEY = 'skinherb_register_draft_v2';

    const saveDraft = () => {
      const draft = {
        firstName: firstNameEl.value,
        lastName: lastNameEl.value,
        age: ageEl.value,
        occupation: occupationEl.value,
        email: emailEl.value
      };
      try { localStorage.setItem(DRAFT_KEY, JSON.stringify(draft)); } catch (_) {}
    };

    const loadDraft = () => {
      try {
        const raw = localStorage.getItem(DRAFT_KEY);
        if (!raw) return;
        const d = JSON.parse(raw);
        if (d.firstName) firstNameEl.value = d.firstName;
        if (d.lastName) lastNameEl.value = d.lastName;
        if (d.age) ageEl.value = d.age;
        if (d.occupation) occupationEl.value = d.occupation;
        if (d.email) emailEl.value = d.email;
      } catch (_) {}
    };

    loadDraft();
    normalizeInputs();
    renderPasswordStrength();
    applyPasswordValidity();
    updateSubmitState();
    </script>
</body>
</html>
